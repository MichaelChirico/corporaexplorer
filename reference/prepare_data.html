<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Prepare data for corpus exploration — prepare_data • corporaexplorer</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Prepare data for corpus exploration — prepare_data" />
<meta property="og:description" content="Convert data frame or character vector to a ‘corporaexplorerobject’
  for subsequent exploration." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-130957512-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-130957512-2');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">corporaexplorer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/usage.html">How to use</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/jane_austen.html">Demo app: Jane Austen's novels</a>
    </li>
    <li>
      <a href="../articles/sotu.html">Demo app: State of the Union addresses</a>
    </li>
    <li>
      <a href="../articles/bible.html">The Bible</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Deployment
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/deployment.html">Use with Shiny Server and shinyapps.io</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kgjerde/corporaexplorer/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Prepare data for corpus exploration</h1>
    <small class="dont-index">Source: <a href='https://github.com/kgjerde/corporaexplorer/blob/master/R/prepare_data.R'><code>R/prepare_data.R</code></a></small>
    <div class="hidden name"><code>prepare_data.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Convert data frame or character vector to a ‘corporaexplorerobject’
  for subsequent exploration.</p>
    </div>

    <pre class="usage"><span class='fu'>prepare_data</span><span class='op'>(</span><span class='va'>dataset</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for data.frame</span>
<span class='fu'>prepare_data</span><span class='op'>(</span>
  <span class='va'>dataset</span>,
  date_based_corpus <span class='op'>=</span> <span class='cn'>TRUE</span>,
  grouping_variable <span class='op'>=</span> <span class='cn'>NULL</span>,
  within_group_identifier <span class='op'>=</span> <span class='st'>"Seq"</span>,
  columns_doc_info <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Date"</span>, <span class='st'>"Title"</span>, <span class='st'>"URL"</span><span class='op'>)</span>,
  corpus_name <span class='op'>=</span> <span class='cn'>NULL</span>,
  use_matrix <span class='op'>=</span> <span class='cn'>TRUE</span>,
  matrix_without_punctuation <span class='op'>=</span> <span class='cn'>TRUE</span>,
  tile_length_range <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>10</span><span class='op'>)</span>,
  columns_for_ui_checkboxes <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for character</span>
<span class='fu'>prepare_data</span><span class='op'>(</span>
  <span class='va'>dataset</span>,
  corpus_name <span class='op'>=</span> <span class='cn'>NULL</span>,
  use_matrix <span class='op'>=</span> <span class='cn'>TRUE</span>,
  matrix_without_punctuation <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dataset</th>
      <td><p>Object to convert to corporaexplorerobject:</p><ul>
<li><p>A data frame with a column "Text" (class
  character), and optionally other columns.
  If <code>date_based_corpus</code> is <code>TRUE</code> (the default),
  <code>dataset</code> must contain a column "Date" (of class Date).</p></li>
<li><p>Or a non-empty character vector.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments to be passed to <code>prepare_data</code>.</p></td>
    </tr>
    <tr>
      <th>date_based_corpus</th>
      <td><p>Logical. Set to <code>FALSE</code> if the corpus
is not to be organised according to document dates.</p></td>
    </tr>
    <tr>
      <th>grouping_variable</th>
      <td><p>Character string.
If <code>date_based_corpus</code> is <code>TRUE</code>, this argument is ignored.
If <code>date_based_corpus</code> is <code>FALSE</code>, this argument can be used
to group the documents, e.g. if <code>dataset</code> is organised by chapters
belonging to different books.</p></td>
    </tr>
    <tr>
      <th>within_group_identifier</th>
      <td><p>Character string indicating column name in <code>dataset</code>.
<code>"Seq"</code>, the default, means the rows in each group are assigned
a numeric sequence 1:n where n is the number of rows in the group.
Used in document tab title in non-date based corpora.
If <code>date_based_corpus</code> is <code>TRUE</code>, this argument is ignored.</p></td>
    </tr>
    <tr>
      <th>columns_doc_info</th>
      <td><p>Character vector. The columns from <code>dataset</code> to display in
the "document information" tab in the corpus exploration app. By default
"Date", "Title" and "URL" will be
displayed, if included. If <code>columns_doc_info</code> includes a column which is not
present in dataset, it will be ignored.</p></td>
    </tr>
    <tr>
      <th>corpus_name</th>
      <td><p>Character string with name of corpus.</p></td>
    </tr>
    <tr>
      <th>use_matrix</th>
      <td><p>Logical. Should the function create a document term matrix
for fast searching? If <code>TRUE</code>, data preparation will run longer and demand
more memory. If <code>FALSE</code>, the returning corporaexplorerobject will be more light-weight, but
searching will be slower.</p></td>
    </tr>
    <tr>
      <th>matrix_without_punctuation</th>
      <td><p>Should punctuation and digits be stripped
  from the text before constructing the document term matrix? If <code>TRUE</code>,
  the default:</p><ul>
<li><p>The corporaexplorer object will be lighter and most searches in
    the corpus exploration app will be faster.</p></li>
<li><p>Searches including punctuation and digits will be carried out in
    the full text documents.</p></li>
<li><p>The only "risk" with this strategy is that the corpus exploration
    app in some cases can produce false positives. E.g. searching for the
    term "donkey" will also find the term "don%key".
This should not be a problem for the vast opportunity of use cases, but if
one so desires, there are three different solutions: set this parameter to
<code>FALSE</code>, create a corporaexplorerobject without a matrix by setting
the <code>use_matrix</code> parameter to <code>FALSE</code>, or run
<code><a href='explore.html'>explore</a></code> with the
<code>use_matrix</code> parameter set to <code>FALSE</code>.</p></li>
</ul><p>If <code>FALSE</code>, the corporaexplorer object will be larger, and most
 simple searches will be slower.</p></td>
    </tr>
    <tr>
      <th>tile_length_range</th>
      <td><p>Numeric vector of length two.
Fine-tune the tile lengths in document wall
and day corpus view. Tile length is calculated by
<code><a href='https://scales.r-lib.org//reference/rescale.html'>scales::rescale(nchar(dataset$Text),
to = tile_length_range,
from = c(0, max(.)))</a></code>
Default is <code><a href='https://rdrr.io/r/base/c.html'>c(1, 10)</a></code>.</p></td>
    </tr>
    <tr>
      <th>columns_for_ui_checkboxes</th>
      <td><p>Character. Character or factor column(s) in dataset.
Include sets of checkboxes in the app sidebar for
convenient filtering of corpus.
Typical useful for columns with a small set of unique
(and short) values.
Checkboxes will be arranged by <code><a href='https://rdrr.io/r/base/sort.html'>sort()</a></code>,
unless <code>columns_for_ui_checkboxes</code>
is a vector of factors, in which case the order will be according to
factor level order (easy relevelling with <code>forcats::fct_relevel()</code>).
To use a different
label in the sidebar than the columnn name,
simply pass a named character vector to <code>columns_for_ui_checkboxes</code>.
If <code>columns_for_ui_checkboxes</code> includes a column which is not
present in dataset, it will be ignored.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>corporaexplorer</code> object to be passed as argument to
  <code><a href='explore.html'>explore</a></code> and
  <code><a href='run_document_extractor.html'>run_document_extractor</a></code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For data.frame: Each row in <code>dataset</code> is treated as a base differentiating unit in the corpus,
  typically chapters in books, or a single document in document collections.
  The following column names are reserved and cannot be used in <code>dataset</code>:
  "ID",
  "Text_original_case",
  "Tile_length",
  "Year",
  "Seq",
  "Weekday_n",
  "Day_without_docs",
  "Invisible_fake_date",
  "Tile_length".</p>
<p>A character vector will be converted to a simple corporaexplorerobject
  with no metadata.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## From data.frame</span>
<span class='co'># Constructing test data frame:</span>
<span class='va'>dates</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='fl'>2011</span><span class='op'>:</span><span class='fl'>2020</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span>, <span class='fl'>21</span><span class='op'>:</span><span class='fl'>30</span>, sep <span class='op'>=</span> <span class='st'>"-"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>texts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span>
  <span class='st'>"This is a document about "</span>, <span class='va'>month.name</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>]</span>, <span class='st'>". "</span>,
  <span class='st'>"This is not a document about "</span>, <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>month.name</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>]</span><span class='op'>)</span>, <span class='st'>"."</span>
<span class='op'>)</span>
<span class='va'>titles</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Text"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span>
<span class='va'>test_df</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='fu'>::</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>Date <span class='op'>=</span> <span class='va'>dates</span>, Text <span class='op'>=</span> <span class='va'>texts</span>, Title <span class='op'>=</span> <span class='va'>titles</span><span class='op'>)</span>

<span class='co'># Converting to corporaexplorerobject:</span>
<span class='va'>corpus</span> <span class='op'>&lt;-</span> <span class='fu'>prepare_data</span><span class='op'>(</span><span class='va'>test_df</span>, corpus_name <span class='op'>=</span> <span class='st'>"Test corpus"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Starting.</span></div><div class='output co'>#&gt; <span class='message'>Document data frame done.</span></div><div class='output co'>#&gt; <span class='message'>Calendar data frame done.</span></div><div class='output co'>#&gt; <span class='message'>Document term matrix: text processed.</span></div><div class='output co'>#&gt; <span class='message'>Document term matrix: tokenising completed.</span></div><div class='output co'>#&gt; <span class='message'>Document term matrix: word list created.</span></div><div class='output co'>#&gt; <span class='message'>Document term matrix done.</span></div><div class='output co'>#&gt; <span class='message'>Done.</span></div><div class='input'>
<span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
<span class='co'># Running exploration app:</span>
<span class='fu'><a href='explore.html'>explore</a></span><span class='op'>(</span><span class='va'>corpus</span><span class='op'>)</span>

<span class='co'># Running app to extract documents:</span>
<span class='fu'><a href='run_document_extractor.html'>run_document_extractor</a></span><span class='op'>(</span><span class='va'>corpus</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'>## From character vector</span>
<span class='va'>alphabet_corpus</span> <span class='op'>&lt;-</span> <span class='fu'>prepare_data</span><span class='op'>(</span><span class='va'>LETTERS</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Starting.</span></div><div class='output co'>#&gt; <span class='message'>Document data frame done.</span></div><div class='output co'>#&gt; <span class='message'>Corpus is not date based. Calendar data frame skipped.</span></div><div class='output co'>#&gt; <span class='message'>Document term matrix: text processed.</span></div><div class='output co'>#&gt; <span class='message'>Document term matrix: tokenising completed.</span></div><div class='output co'>#&gt; <span class='message'>Document term matrix: word list created.</span></div><div class='output co'>#&gt; <span class='message'>Document term matrix done.</span></div><div class='output co'>#&gt; <span class='message'>Done.</span></div><div class='input'>
<span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
<span class='co'># Running exploration app:</span>
<span class='fu'><a href='explore.html'>explore</a></span><span class='op'>(</span><span class='va'>alphabet_corpus</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Kristian Lundby Gjerde.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


